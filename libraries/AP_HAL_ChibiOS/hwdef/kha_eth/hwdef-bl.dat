# hw definition file for processing by chibios_hwdef.py
# for H743 bootloader

# MCU class and specific type
MCU STM32H7xx STM32H743xx

define WATCHDOG_DISABLED

# crystal frequency
OSCILLATOR_HZ 25000000

# board ID for firmware load
APJ_BOARD_ID 1315

FLASH_SIZE_KB 2048

# setup build for a peripheral firmware
env AP_PERIPH 1

STORAGE_FLASH_PAGE 14

# the location where the bootloader will put the firmware
# the H743 has 128k sectors
FLASH_RESERVE_START_KB 0
FLASH_BOOTLOADER_LOAD_KB 128
FLASH_RESERVE_END_KB 256

PA0 LED_ACTIVITY OUTPUT LOW
PE9 LED_BOOTLOADER OUTPUT LOW
define HAL_LED_ON 1

PA13 JTMS-SWDIO SWD
PA14 JTCK-SWCLK SWD

PB8 CAN1_RX CAN1
PB9 CAN1_TX CAN1

PA11 OTG_FS_DM OTG1
PA12 OTG_FS_DP OTG1

# UART 1 - Avionics
#PA9 USART1_TX USART1
#PA10 USART1_RX USART1

# UART 2 - Avionics
#PD5 USART2_TX USART2
#PD6 USART2_RX USART2

# UART 3 - unused, J2 (2 pin)
PC10 UART4_TX UART4
PC11 UART4_RX UART4

# UART 4 - unused, J6 (4 pin)
PE7 UART7_RX UART7
PE8 UART7_TX UART7


# order of UARTs (and USB)
SERIAL_ORDER OTG1 UART4 UART7
define BOOTLOADER_DEBUG SD7

define CAN_APP_NODE_NAME "com.kha.eth-bl"

# use a small bootloader timeout
define HAL_BOOTLOADER_TIMEOUT 3000

#PA7 ETH_RMII_CRS_DV OUTPUT LOW
#PC4 ETH_RMII_RXD0 OUTPUT HIGH
#PC5 ETH_RMII_RXD1 OUTPUT LOW
#PA15 GPIO_ETH_RESET_N OUTPUT LOW
PA15 GPIO_ETH_RESET_N INPUT FLOATING
